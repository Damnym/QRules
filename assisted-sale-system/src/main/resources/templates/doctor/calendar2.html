<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1" charset="UTF-8" />
	<title>Doctors Calendar</title>
	
	<link rel="stylesheet" type="text/css" th:href="@{/css/bootstrap.min.css}">
	<link rel="stylesheet" type="text/css" th:href="@{/css/jquery-ui.min.css}">
	
	<link rel="stylesheet" type="text/css" th:href="@{/css/style.css}" />
	<link rel="stylesheet" type="text/css" th:href="@{/css/evo/evo-calendar.css}" />
	<link rel="stylesheet" type="text/css" th:href="@{/css/evo/evo-calendar.royal-navy.css}" />
<!-- 	<link rel="stylesheet" type="text/css" th:href="@{/css/evo/evo-calendar.midnight-blue.css}" /> -->
	<link  rel="icon" th:href="@{/imgs/3051.png}" type="image/png" />
</head>

<body style="background-color: #27344D">
	<div class="card bg-white" align="center" style="width: 100%;">
		<div class="card-header py-1 font-weight-bold text-white" align="center" style="background-color:#14233E">
			<div class="row">
				<div class="col-1">
					<a  th:href="@{/index}"><img th:src="@{/imgs/3051.png}" alt="logo" class="rounded mx-auto d-block float-left"></a>
				</div>
				<div th:each="d: ${doctors}" class="col">
					<span th:if="${d.id} == ${doctor.id}"  th:text="${d.name}" class="btn btn-305bw btn-block" style="text-decoration: underline!important;"></span>	
					<a th:unless="${d.id} == ${doctor.id}" th:text="${d.name}" class="btn btn-305bw btn-block" th:href="@{/doctor/calendar/} + ${d	.id}"></a>	
				</div>
			</div>	
		</div>
		<div class="card-body" align="center">
			<div class="row">
				<div class="col-10">
					<p id="regular" hidden="hidden" th:text="${regularDate}"></p>
					<p id="vip"     hidden="hidden" th:text="${VIPDate}"></p>
					<p id="quota"   hidden="hidden" th:text="${quotaDate}"></p>
					
					<span hidden="true" th:id="idDoctor" th:text="${doctor.id}"> </span>
					
					<div id="calendar" class="royal-navy"  onshow="itemsHelper.setEvent();"></div>			
				</div>	 
				<div class="col-2">
					<div class="row">
						<a th:href="@{#}" th:text="'Go regular date'" class="btn btn-block btn-danger" 
						   th:onclick="'itemsHelper.goRegularDate();'"></a>
					</div>
					<div class="row mt-3">
						<a th:href="@{#}" th:text="'Go VIP date'" class="btn btn-block btn-warning"
						   th:onclick="'itemsHelper.goVIPDate();'"></a>
					</div>
					<div th:if="${quotaDate}" class="row mt-3">
						<a th:href="@{#}" th:text="'Go first available spots'" class="btn btn-block btn-success"
					       th:onclick="'itemsHelper.goFirstQuota();'"></a>
					</div>
				</div>
			</div>
		</div>
	</div>
		
	
<script th:src="@{/js/jquery-3.5.1.min.js}"></script>
<script th:src="@{/js/popper.min.js}"></script>
<script th:src="@{/js/bootstrap.min.js}"></script>
<script th:src="@{/js/jquery-ui.min.js}"></script>
<script th:src="@{/js/evo/evo-calendar.js}"></script>

<script>
	$(document).ready(function() 
	 {
	 	$('#calendar').evoCalendar(
		 {
			'eventDisplayDefault': false,
 			'format': 'yyyy-MM-dd' 
		 });
	 	
	 	$.ajax({
	 	    url: "/doctor/load-quotas/" + parseInt($(idDoctor).html()), 
 	 	    dataType : "json",
	 	    
	 	    success: function(respuesta) {
//  	    	console.log(respuesta);
 	 	     $.each(respuesta, function(index, elemento) {
 	 	    	$('#calendar').evoCalendar('addCalendarEvent', [ elemento ]); 
 	 	      });
	 	    },
	 	    error: function() {
	 	      console.log("No se ha podido obtener la información");
	 	    }
	 	  });
		
		$('#calendar').evoCalendar('addCalendarEvent', [
		 {
		 	id: 'kNybja6',
		    name: 'Regular date',
			date:  document.getElementById("regular").innerText,
			type: 'event',
			color: '#DC3545',
			everyYear: true // optional
		 },
		 {
		    id: 'asDf87L',
		    name: 'VIP date',
			date:  document.getElementById("vip").innerText,
		    type: 'event',
		    color: '#E0A801',
			everyYear: true // optional
		 }
		]);
	 });
	
	var itemsHelper = 
	{
		goRegularDate: function()
		{
			$('#calendar').evoCalendar('selectDate', document.getElementById("regular").innerText);
		},
		goVIPDate: function()
		{
			$('#calendar').evoCalendar('selectDate', document.getElementById("vip").innerText);
		},
		goFirstQuota: function()
		{
			$('#calendar').evoCalendar('selectDate', document.getElementById("quota").innerText);
		},
     }
	 
	 
		
	</script>

</body>
</html>